<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login | RPS.py Download</title>
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Link to stylesheet - flat structure -->
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <header class="payment-header">
        <div class="container payment-header-content">
            <h1>Account Verification</h1>
            <p>Sign in with your Google account to access your download</p>
        </div>
    </header>

    <div class="container">
        <div class="payment-container">
            <div class="payment-title">
                <h2>Verify Your Account</h2>
            </div>
            
            <div class="payment-body" style="text-align: center;">
                <div style="margin: 2rem 0;">
                    <div style="font-size: 4rem; color: #4285F4; margin-bottom: 1.5rem;">
                        <i class="fab fa-google"></i>
                    </div>
                    <p style="margin-bottom: 2rem; color: #7f8c8d;">You're almost there! Sign in with Google to verify your account and access your download.</p>
                    <button id="google-login" class="btn btn-google">
                        <i class="fab fa-google" style="margin-right: 8px;"></i> Sign in with Google
                    </button>
                </div>
                
                <div id="login-status" class="hidden" style="margin-top: 1.5rem; padding: 1rem; background-color: #f8f9fa; border-radius: 8px;">
                    <div class="loader" style="border: 3px solid #f3f3f3; border-radius: 50%; border-top: 3px solid #3498db; width: 24px; height: 24px; animation: spin 1s linear infinite; margin: 0 auto 0.5rem auto; display: block;"></div>
                    <p>Verifying your account...</p>
                </div>
                
                <div style="margin-top: 2rem; border-top: 1px solid #e9ecef; padding-top: 1.5rem;">
                    <a href="index.html" style="color: #7f8c8d; text-decoration: none; display: inline-flex; align-items: center;">
                        <i class="fas fa-arrow-left" style="margin-right: 5px;"></i>
                        Return to home page
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-links">
                <a href="#">Terms of Service</a>
                <a href="#">Privacy Policy</a>
                <a href="#">Contact Us</a>
            </div>
            <p>&copy; 2025 Unlimited Money Limited LLC. All rights reserved.</p>
        </div>
    </footer>
    
    <!-- Firebase SDKs - Using version 8.x for compatibility -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    
    <!-- App scripts - flat structure -->
    <script src="auth.js"></script>
    
    <style>
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .btn-google {
            background: #4285F4;
            color: white;
        }
        
        .btn-google:hover {
            background: #3367D6;
        }
        
        /* Debug console */
        #debug-console {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 100px;
            background: rgba(0,0,0,0.8);
            color: #2ecc71;
            font-family: monospace;
            font-size: 12px;
            padding: 10px;
            overflow-y: auto;
            z-index: 9999;
            display: none;
        }
    </style>
    
    <!-- Debug console for troubleshooting -->
    <div id="debug-console"></div>
    
    <script>
        // Helper for debugging
        function debugLog(message) {
            const debug = document.getElementById('debug-console');
            debug.style.display = 'block';
            const logEntry = document.createElement('div');
            logEntry.textContent = new Date().toISOString().substr(11, 8) + ': ' + message;
            debug.appendChild(logEntry);
            debug.scrollTop = debug.scrollHeight;
            console.log(message);
        }
        
        // Show debug console in development
        document.addEventListener('keydown', function(e) {
            // Press D key to toggle debug console
            if (e.key === 'd' && e.ctrlKey) {
                const debug = document.getElementById('debug-console');
                debug.style.display = debug.style.display === 'none' ? 'block' : 'none';
            }
        });
        
        // Additional event listener as a fallback
        document.addEventListener('DOMContentLoaded', function() {
            const loginBtn = document.getElementById('google-login');
            if (loginBtn) {
                loginBtn.addEventListener('click', function() {
                    debugLog('Login button clicked via inline handler');
                    const provider = new firebase.auth.GoogleAuthProvider();
                    
                    // Show login status
                    const loginStatus = document.getElementById('login-status');
                    if (loginStatus) loginStatus.classList.remove('hidden');
                    
                    firebase.auth().signInWithPopup(provider).then(function(result) {
                        debugLog('Google sign-in successful');
                        window.location.href = 'download.html';
                    }).catch(function(error) {
                        debugLog('Error: ' + error.message);
                        if (error.code === 'auth/popup-blocked') {
                            debugLog('Popup blocked, trying redirect');
                            firebase.auth().signInWithRedirect(provider);
                        }
                    });
                });
            } else {
                debugLog('Login button not found!');
            }
        });
    </script>
</body>
</html>
